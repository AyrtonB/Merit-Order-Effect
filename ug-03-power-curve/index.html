
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.2">
    
    
      
        <title>Power Curve - Merit-Order-Effect</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.73f7c429.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.39b8e14a.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#wind-power-curve-fitting-cleaning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Merit-Order-Effect" class="md-header-nav__button md-logo" aria-label="Merit-Order-Effect">
      
  <img src="../assets/images/logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Merit-Order-Effect
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Power Curve
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/AyrtonB/Merit-Order-Effect/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    AyrtonB/Merit-Order-Effect
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../ug-08-lowess-quick-start/" class="md-tabs__link">
        User Guide
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../ug-01-hydro-seasonality/" class="md-tabs__link md-tabs__link--active">
        Examples
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../dev-01-retrieval/" class="md-tabs__link">
        Development
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Merit-Order-Effect" class="md-nav__button md-logo" aria-label="Merit-Order-Effect">
      
  <img src="../assets/images/logo.svg" alt="logo">

    </a>
    Merit-Order-Effect
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/AyrtonB/Merit-Order-Effect/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    AyrtonB/Merit-Order-Effect
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    
    <label class="md-nav__link" for="nav-2">
      User Guide
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="User Guide" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../ug-08-lowess-quick-start/" class="md-nav__link">
      LOWESS Quick-Start
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../ug-05-data-retrieval/" class="md-nav__link">
      Data Retrieval
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../ug-06-surface-estimation/" class="md-nav__link">
      Surface Estimation
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../ug-07-moe-quantification/" class="md-nav__link">
      MOE Quantification
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Examples
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Examples" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../ug-01-hydro-seasonality/" class="md-nav__link">
      Hydro Seasonality
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../ug-02-ligo/" class="md-nav__link">
      LIGO
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Power Curve
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Power Curve
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#imports" class="md-nav__link">
    Imports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#power-curve-fitting" class="md-nav__link">
    Power Curve Fitting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#power-curve-cleaning" class="md-nav__link">
    Power Curve Cleaning
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../ug-04-electricity-prices/" class="md-nav__link">
      Electricity Prices
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    
    <label class="md-nav__link" for="nav-4">
      Development
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Development" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../dev-01-retrieval/" class="md-nav__link">
      Data Retrieval
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../dev-02-eda/" class="md-nav__link">
      Exploratory Data Analysis
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../dev-03-lowess/" class="md-nav__link">
      LOWESS
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../dev-04-price-surface-estimation/" class="md-nav__link">
      Price Curve Estimation
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../dev-05-price-moe/" class="md-nav__link">
      Price MOE Calculation
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../dev-06-carbon-surface-estimation-and-moe/" class="md-nav__link">
      Carbon Curve Estimation & MOE
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../dev-07-prediction-confidence-and-intervals/" class="md-nav__link">
      Prediction & Confidence Intervals
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../dev-08-hyper-parameter-tuning/" class="md-nav__link">
      Hyper-Parameter Tuning
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../dev-09-tables-and-figures/" class="md-nav__link">
      Tables & Figures
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../dev-10-ci-cd/" class="md-nav__link">
      CI-CD
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#imports" class="md-nav__link">
    Imports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#power-curve-fitting" class="md-nav__link">
    Power Curve Fitting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#power-curve-cleaning" class="md-nav__link">
    Power Curve Cleaning
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/AyrtonB/Merit-Order-Effect/edit/main/docs/ug-03-power-curve.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="wind-power-curve-fitting-cleaning">Wind Power Curve Fitting &amp; Cleaning<a class="headerlink" href="#wind-power-curve-fitting-cleaning" title="Permanent link">&para;</a></h1>
<p><a href="https://notebooks.gesis.org/binder/v2/gh/AyrtonB/Merit-Order-Effect/main?filepath=nbs%2Fug-03-power-curve.ipynb"><img alt="Binder" src="https://notebooks.gesis.org/binder/badge_logo.svg" /></a></p>
<p>In this notebook we'll look at how we can use our LOWESS methods to first fit a power curve for a wind turbine, then estimate the uncertainty in our results. We'll then utilise a feature of the quantile LOWESS fits to demonstrate how these techniques can also be used for cleaning raw turbine data.</p>
<p><br></p>
<h3 id="imports">Imports<a class="headerlink" href="#imports" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">moepy</span> <span class="kn">import</span> <span class="n">lowess</span><span class="p">,</span> <span class="n">eda</span>
</code></pre></div>
<p><br></p>
<h3 id="power-curve-fitting">Power Curve Fitting<a class="headerlink" href="#power-curve-fitting" title="Permanent link">&para;</a></h3>
<p>We'll start by loading in some clean turbine output and wind speed data, this was sourced from the <a href="https://github.com/PCWG/PCWG">Power Curve Working Group Analysis</a> example data repository.</p>
<div class="highlight"><pre><span></span><code><span class="n">df_pcwga</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span>
            <span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/lowess_examples/turbine_power_wind_speed_clean.csv&#39;</span><span class="p">)</span>
            <span class="p">[[</span><span class="s1">&#39;TimeStamp&#39;</span><span class="p">,</span> <span class="s1">&#39;Turbine Wind Speed Mean&#39;</span><span class="p">,</span> <span class="s1">&#39;Turbine Power&#39;</span><span class="p">]]</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mf">99.99</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
           <span class="p">)</span>

<span class="n">df_pcwga</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<table>
<thead>
<tr>
<th align="right">Unnamed: 0</th>
<th align="left">TimeStamp</th>
<th align="right">Turbine Wind Speed Mean</th>
<th align="right">Turbine Power</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">07/10/2011 12:50</td>
<td align="right">15.51</td>
<td align="right">1996.91</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">07/10/2011 13:00</td>
<td align="right">15.7101</td>
<td align="right">1987.74</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">07/10/2011 13:10</td>
<td align="right">16.6708</td>
<td align="right">1991.9</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">07/10/2011 13:20</td>
<td align="right">15.2098</td>
<td align="right">1987.7</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">07/10/2011 13:30</td>
<td align="right">15.44</td>
<td align="right">1991.03</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>We'll then fit a standard LOWESS and visualise the results</p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">time</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df_pcwga</span><span class="p">[</span><span class="s1">&#39;Turbine Wind Speed Mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_pcwga</span><span class="p">[</span><span class="s1">&#39;Turbine Power&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">lowess_model</span> <span class="o">=</span> <span class="n">lowess</span><span class="o">.</span><span class="n">Lowess</span><span class="p">()</span>
<span class="n">lowess_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">num_fits</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lowess_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_pred</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pred</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Robust LOWESS&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observations&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">eda</span><span class="o">.</span><span class="n">hide_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wind Speed (m/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Output (MW)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>

<span class="n">lgnd</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
<span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Wall time: 512 ms
</code></pre></div>
<p><img alt="png" src="../img/nbs/ug-03-power-curve_cell_6_output_1.png" /></p>
<p><br></p>
<p>This looks good but we can do more. In this next step we'll estimate the upper and lower quantiles of the power curve fit that represent a prediction interval of 68%.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Estimating the quantiles</span>
<span class="n">df_quantiles</span> <span class="o">=</span> <span class="n">lowess</span><span class="o">.</span><span class="n">quantile_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">qs</span><span class="o">=</span><span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">],</span> <span class="n">num_fits</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

<span class="c1"># Cleaning names and sorting for plotting</span>
<span class="n">df_quantiles</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;p</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_quantiles</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">df_quantiles</span> <span class="o">=</span> <span class="n">df_quantiles</span><span class="p">[</span><span class="n">df_quantiles</span><span class="o">.</span><span class="n">columns</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">df_quantiles</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<div><span class="Text-label" style="display:inline-block; overflow:hidden; white-space:nowrap; text-overflow:ellipsis; min-width:0; max-width:15ex; vertical-align:middle; text-align:right"></span>
<progress style="width:60ex" max="2" value="2" class="Progress-main"/></progress>
<span class="Progress-label"><strong>100%</strong></span>
<span class="Iteration-label">2/2</span>
<span class="Time-label">[00:06<00:03, 3.19s/it]</span></div>

<table>
<thead>
<tr>
<th align="right">x</th>
<th align="right">p84</th>
<th align="right">p16</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0.323938</td>
<td align="right">-16.2569</td>
<td align="right">-8.34796</td>
</tr>
<tr>
<td align="right">0.463498</td>
<td align="right">-14.4719</td>
<td align="right">-8.53898</td>
</tr>
<tr>
<td align="right">0.475784</td>
<td align="right">-14.3153</td>
<td align="right">-8.55634</td>
</tr>
<tr>
<td align="right">0.503802</td>
<td align="right">-13.9573</td>
<td align="right">-8.59603</td>
</tr>
<tr>
<td align="right">0.546645</td>
<td align="right">-13.4059</td>
<td align="right">-8.65677</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>We'll visualise this fit within the domain where the quantiles do not cross</p>
<div class="highlight"><pre><span></span><code><span class="n">valid_pred_intvl_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_quantiles</span><span class="p">[</span><span class="s1">&#39;p84&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">df_quantiles</span><span class="p">[</span><span class="s1">&#39;p16&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observations&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">valid_pred_intvl_idx</span><span class="p">,</span> <span class="n">df_quantiles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">valid_pred_intvl_idx</span><span class="p">,</span> <span class="s1">&#39;p16&#39;</span><span class="p">],</span> <span class="n">df_quantiles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">valid_pred_intvl_idx</span><span class="p">,</span> <span class="s1">&#39;p84&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;68% Prediction Interval&#39;</span><span class="p">)</span>

<span class="n">eda</span><span class="o">.</span><span class="n">hide_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wind Speed (m/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Output (MW)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">lgnd</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
<span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span>
<span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../img/nbs/ug-03-power-curve_cell_10_output_0.png" /></p>
<p><br></p>
<p>With the prediction interval we've looked at the likely range of power output for given wind speeds, but what if instead of the range of the underlying values we wanted to know the range in our estimate of the average power curve? For this we can use confidence intervals, which express the certainty we have in the particular statistical parameter we're calculating.</p>
<p>In order to estimate this uncertainty we'll first bootstrap our model.</p>
<div class="highlight"><pre><span></span><code><span class="n">df_bootstrap</span> <span class="o">=</span> <span class="n">lowess</span><span class="o">.</span><span class="n">bootstrap_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">num_runs</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">num_fits</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">df_bootstrap</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<div><span class="Text-label" style="display:inline-block; overflow:hidden; white-space:nowrap; text-overflow:ellipsis; min-width:0; max-width:15ex; vertical-align:middle; text-align:right"></span>
<progress style="width:60ex" max="500" value="500" class="Progress-main"/></progress>
<span class="Progress-label"><strong>100%</strong></span>
<span class="Iteration-label">500/500</span>
<span class="Time-label">[00:55<00:00, 0.11s/it]</span></div>

<table>
<thead>
<tr>
<th align="right">x</th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
<th align="right">9</th>
<th align="left">...</th>
<th align="right">490</th>
<th align="right">491</th>
<th align="right">492</th>
<th align="right">493</th>
<th align="right">494</th>
<th align="right">495</th>
<th align="right">496</th>
<th align="right">497</th>
<th align="right">498</th>
<th align="right">499</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">15.51</td>
<td align="right">1977.78</td>
<td align="right">1978.05</td>
<td align="right">1978.95</td>
<td align="right">1978.33</td>
<td align="right">1979.43</td>
<td align="right">1978.33</td>
<td align="right">1978.78</td>
<td align="right">1979.79</td>
<td align="right">1979.47</td>
<td align="right">1979</td>
<td align="left">...</td>
<td align="right">1978.14</td>
<td align="right">1978.5</td>
<td align="right">1977.23</td>
<td align="right">1977.66</td>
<td align="right">1976.37</td>
<td align="right">1976.28</td>
<td align="right">1978.61</td>
<td align="right">1978.84</td>
<td align="right">1977.94</td>
<td align="right">1977.22</td>
</tr>
<tr>
<td align="right">15.7101</td>
<td align="right">1978.48</td>
<td align="right">1978.6</td>
<td align="right">1979.52</td>
<td align="right">1979.05</td>
<td align="right">1979.96</td>
<td align="right">1979.06</td>
<td align="right">1979.39</td>
<td align="right">1980.34</td>
<td align="right">1980.1</td>
<td align="right">1979.74</td>
<td align="left">...</td>
<td align="right">1978.92</td>
<td align="right">1979.14</td>
<td align="right">1977.82</td>
<td align="right">1978.38</td>
<td align="right">1977.14</td>
<td align="right">1977.14</td>
<td align="right">1979.45</td>
<td align="right">1979.56</td>
<td align="right">1978.61</td>
<td align="right">1977.96</td>
</tr>
<tr>
<td align="right">16.6708</td>
<td align="right">1981.24</td>
<td align="right">1981.17</td>
<td align="right">1981.83</td>
<td align="right">1981.57</td>
<td align="right">1981.87</td>
<td align="right">1981.95</td>
<td align="right">1981.61</td>
<td align="right">1982.23</td>
<td align="right">1982.3</td>
<td align="right">1982.31</td>
<td align="left">...</td>
<td align="right">1981.98</td>
<td align="right">1981.56</td>
<td align="right">1980.13</td>
<td align="right">1981.42</td>
<td align="right">1980.3</td>
<td align="right">1980.6</td>
<td align="right">1982.85</td>
<td align="right">1981.93</td>
<td align="right">1981.15</td>
<td align="right">1980.83</td>
</tr>
<tr>
<td align="right">15.2098</td>
<td align="right">1976.43</td>
<td align="right">1977.04</td>
<td align="right">1977.8</td>
<td align="right">1977.1</td>
<td align="right">1978.41</td>
<td align="right">1976.9</td>
<td align="right">1977.58</td>
<td align="right">1978.67</td>
<td align="right">1978.21</td>
<td align="right">1977.58</td>
<td align="left">...</td>
<td align="right">1976.64</td>
<td align="right">1977.27</td>
<td align="right">1976.05</td>
<td align="right">1976.45</td>
<td align="right">1974.94</td>
<td align="right">1974.57</td>
<td align="right">1977.02</td>
<td align="right">1977.52</td>
<td align="right">1976.61</td>
<td align="right">1975.82</td>
</tr>
<tr>
<td align="right">15.44</td>
<td align="right">1977.49</td>
<td align="right">1977.84</td>
<td align="right">1978.72</td>
<td align="right">1978.03</td>
<td align="right">1979.21</td>
<td align="right">1978.03</td>
<td align="right">1978.52</td>
<td align="right">1979.56</td>
<td align="right">1979.2</td>
<td align="right">1978.69</td>
<td align="left">...</td>
<td align="right">1977.83</td>
<td align="right">1978.23</td>
<td align="right">1976.99</td>
<td align="right">1977.4</td>
<td align="right">1976.06</td>
<td align="right">1975.93</td>
<td align="right">1978.28</td>
<td align="right">1978.54</td>
<td align="right">1977.66</td>
<td align="right">1976.92</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>From the bootstrapped results we can then extract the confidence intervals, in our case we'll look at the range covering 95% of our estimates.</p>
<div class="highlight"><pre><span></span><code><span class="n">df_conf_intvl</span> <span class="o">=</span> <span class="n">lowess</span><span class="o">.</span><span class="n">get_confidence_interval</span><span class="p">(</span><span class="n">df_bootstrap</span><span class="p">,</span> <span class="n">conf_pct</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observations&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">df_conf_intvl</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_conf_intvl</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span> <span class="n">df_conf_intvl</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% Confidence&#39;</span><span class="p">)</span>

<span class="n">eda</span><span class="o">.</span><span class="n">hide_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wind Speed (m/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Output (MW)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">lgnd</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
<span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span>
<span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../img/nbs/ug-03-power-curve_cell_14_output_0.png" /></p>
<p><br></p>
<p>We'll now visualise how the width of the confidence interval changes with wind speed. Interestingly the two troughs in the confidence interval width appear to correspond to the cut-in and start of the rated power wind speeds.</p>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">df_conf_intvl</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">eda</span><span class="o">.</span><span class="n">hide_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wind Speed (m/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;95% Confidence</span><span class="se">\n</span><span class="s1">Interval Width (MW)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</code></pre></div>
<p><img alt="png" src="../img/nbs/ug-03-power-curve_cell_16_output_0.png" /></p>
<div class="highlight"><pre><span></span><code><span class="c1"># take the peak, then get the troughs on either side and print some info</span>
<span class="c1"># would be interesting to compare against these fits - https://www.hindawi.com/journals/jen/2016/8519785/tab1/</span>
</code></pre></div>
<p><br></p>
<h3 id="power-curve-cleaning">Power Curve Cleaning<a class="headerlink" href="#power-curve-cleaning" title="Permanent link">&para;</a></h3>
<p>We'll start by loading the raw turbine wind speed and output data in</p>
<div class="highlight"><pre><span></span><code><span class="n">df_raw_pc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/lowess_examples/turbine_power_wind_speed_raw.csv&#39;</span><span class="p">)</span>

<span class="n">df_raw_pc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th align="right">Unnamed: 0</th>
<th align="left">UTC</th>
<th align="right">active_power</th>
<th align="right">wind_speed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">30/09/2017 18:26</td>
<td align="right">14</td>
<td align="right">4.02</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">30/09/2017 18:56</td>
<td align="right">14</td>
<td align="right">4.02</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">30/09/2017 19:26</td>
<td align="right">14</td>
<td align="right">4.02</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>We'll then try and fit a LOWESS estimate for the power curve.</p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">time</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df_raw_pc</span><span class="p">[</span><span class="s1">&#39;wind_speed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_raw_pc</span><span class="p">[</span><span class="s1">&#39;active_power&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">lowess_model</span> <span class="o">=</span> <span class="n">lowess</span><span class="o">.</span><span class="n">Lowess</span><span class="p">()</span>
<span class="n">lowess_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">num_fits</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lowess_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_pred</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pred</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Robust LOWESS&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observations&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">eda</span><span class="o">.</span><span class="n">hide_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wind Speed (m/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Output (MW)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>

<span class="n">lgnd</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
<span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Wall time: 788 ms
</code></pre></div>
<p><img alt="png" src="../img/nbs/ug-03-power-curve_cell_21_output_1.png" /></p>
<p><br></p>
<p>Unfortunately the fit is thrown by the large number of occurences where the farm is under-powered or set to output 0, we want to remove these so that we can estimate the 'standard' power curve. We'll create a quantile LOWESS fit to see if that helps us understand the data any better.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Estimating the quantiles</span>
<span class="n">df_quantiles</span> <span class="o">=</span> <span class="n">lowess</span><span class="o">.</span><span class="n">quantile_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">qs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span> <span class="n">num_fits</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

<span class="c1"># Cleaning names and sorting for plotting</span>
<span class="n">df_quantiles</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;p</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_quantiles</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">df_quantiles</span> <span class="o">=</span> <span class="n">df_quantiles</span><span class="p">[</span><span class="n">df_quantiles</span><span class="o">.</span><span class="n">columns</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">df_quantiles</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<div><span class="Text-label" style="display:inline-block; overflow:hidden; white-space:nowrap; text-overflow:ellipsis; min-width:0; max-width:15ex; vertical-align:middle; text-align:right"></span>
<progress style="width:60ex" max="41" value="41" class="Progress-main"/></progress>
<span class="Progress-label"><strong>100%</strong></span>
<span class="Iteration-label">41/41</span>
<span class="Time-label">[02:52<00:05, 4.20s/it]</span></div>

<table>
<thead>
<tr>
<th align="right">x</th>
<th align="right">p97</th>
<th align="right">p95</th>
<th align="right">p92</th>
<th align="right">p90</th>
<th align="right">p88</th>
<th align="right">p85</th>
<th align="right">p83</th>
<th align="right">p80</th>
<th align="right">p78</th>
<th align="right">p76</th>
<th align="left">...</th>
<th align="right">p23</th>
<th align="right">p21</th>
<th align="right">p19</th>
<th align="right">p16</th>
<th align="right">p14</th>
<th align="right">p12</th>
<th align="right">p9</th>
<th align="right">p7</th>
<th align="right">p4</th>
<th align="right">p2</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0.25</td>
<td align="right">-31.1389</td>
<td align="right">-36.0637</td>
<td align="right">-48.7875</td>
<td align="right">-50.2252</td>
<td align="right">-54.3752</td>
<td align="right">-61.8818</td>
<td align="right">-64.9263</td>
<td align="right">-67.3705</td>
<td align="right">-68.176</td>
<td align="right">-69.0324</td>
<td align="left">...</td>
<td align="right">-78.7881</td>
<td align="right">-73.9447</td>
<td align="right">-69.322</td>
<td align="right">-63.1938</td>
<td align="right">-58.9408</td>
<td align="right">-54.0337</td>
<td align="right">-50.6578</td>
<td align="right">-49.2366</td>
<td align="right">-50.801</td>
<td align="right">-51.8248</td>
</tr>
<tr>
<td align="right">0.33</td>
<td align="right">-24.4137</td>
<td align="right">-30.6108</td>
<td align="right">-43.6044</td>
<td align="right">-45.5205</td>
<td align="right">-49.913</td>
<td align="right">-57.5452</td>
<td align="right">-60.7292</td>
<td align="right">-63.275</td>
<td align="right">-64.2354</td>
<td align="right">-65.2338</td>
<td align="left">...</td>
<td align="right">-77.3919</td>
<td align="right">-72.8946</td>
<td align="right">-68.5794</td>
<td align="right">-62.7402</td>
<td align="right">-58.6804</td>
<td align="right">-53.9613</td>
<td align="right">-50.6087</td>
<td align="right">-49.1445</td>
<td align="right">-50.546</td>
<td align="right">-51.5789</td>
</tr>
<tr>
<td align="right">0.41</td>
<td align="right">-17.8378</td>
<td align="right">-25.26</td>
<td align="right">-38.5274</td>
<td align="right">-40.8969</td>
<td align="right">-45.5215</td>
<td align="right">-53.2747</td>
<td align="right">-56.5928</td>
<td align="right">-59.2317</td>
<td align="right">-60.3441</td>
<td align="right">-61.4871</td>
<td align="left">...</td>
<td align="right">-76.014</td>
<td align="right">-71.8585</td>
<td align="right">-67.8522</td>
<td align="right">-62.3073</td>
<td align="right">-58.4534</td>
<td align="right">-53.9134</td>
<td align="right">-50.5746</td>
<td align="right">-49.0702</td>
<td align="right">-50.2914</td>
<td align="right">-51.3353</td>
</tr>
<tr>
<td align="right">0.49</td>
<td align="right">-11.3659</td>
<td align="right">-19.9748</td>
<td align="right">-33.5237</td>
<td align="right">-36.3257</td>
<td align="right">-41.1744</td>
<td align="right">-49.0455</td>
<td align="right">-52.4947</td>
<td align="right">-55.22</td>
<td align="right">-56.4821</td>
<td align="right">-57.7727</td>
<td align="left">...</td>
<td align="right">-74.6419</td>
<td align="right">-70.8232</td>
<td align="right">-67.1261</td>
<td align="right">-61.8803</td>
<td align="right">-58.2436</td>
<td align="right">-53.8769</td>
<td align="right">-50.5466</td>
<td align="right">-49.0072</td>
<td align="right">-50.0365</td>
<td align="right">-51.0934</td>
</tr>
<tr>
<td align="right">0.57</td>
<td align="right">-4.9476</td>
<td align="right">-14.7154</td>
<td align="right">-28.557</td>
<td align="right">-31.7751</td>
<td align="right">-36.8429</td>
<td align="right">-44.8302</td>
<td align="right">-48.4098</td>
<td align="right">-51.2177</td>
<td align="right">-52.6278</td>
<td align="right">-54.069</td>
<td align="left">...</td>
<td align="right">-73.2619</td>
<td align="right">-69.7745</td>
<td align="right">-66.3859</td>
<td align="right">-61.4438</td>
<td align="right">-58.0338</td>
<td align="right">-53.8375</td>
<td align="right">-50.5151</td>
<td align="right">-48.9481</td>
<td align="right">-49.7806</td>
<td align="right">-50.8524</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Plotting these we can see an interesting relationship, where for many of the lower quantiles the estimate peaks then quickly drops to around 0. It is the area below and to the right of these peaks that we want to remove from our power curve estimate.</p>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_quantiles</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">eda</span><span class="o">.</span><span class="n">hide_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wind Speed (m/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Output (MW)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>(0.0, 2557.302509884304)
</code></pre></div>
<p><img alt="png" src="../img/nbs/ug-03-power-curve_cell_25_output_1.png" /></p>
<p><br></p>
<p>We'll first identify the ratio between the peak value and the final value (above speeds of 25 m/s). We'll then remove points after the peak where the ratio between their peak and final values exceeds a defined threshold (in our case 2).</p>
<p>N.b. there's probably a much nicer way to do this where the for loop isn't needed, this would be handy to implement as it would be good to have a vector containing all of the indexes that have been removed.</p>
<div class="highlight"><pre><span></span><code><span class="n">exceeded_quantiles</span> <span class="o">=</span> <span class="p">((</span><span class="n">df_quantiles</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">df_quantiles</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
                      <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                      <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
                      <span class="o">.</span><span class="n">index</span>
                     <span class="p">)</span>

<span class="n">s_maxs</span> <span class="o">=</span> <span class="n">df_quantiles</span><span class="p">[</span><span class="n">exceeded_quantiles</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">s_idxmaxs</span> <span class="o">=</span> <span class="n">df_quantiles</span><span class="p">[</span><span class="n">exceeded_quantiles</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>

<span class="n">cleaned_x</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">cleaned_y</span> <span class="o">=</span> <span class="n">y</span>

<span class="k">for</span> <span class="n">exceeded_quantile</span> <span class="ow">in</span> <span class="n">exceeded_quantiles</span><span class="p">:</span>
    <span class="n">min_x</span> <span class="o">=</span> <span class="n">s_idxmaxs</span><span class="p">[</span><span class="n">exceeded_quantile</span><span class="p">]</span>
    <span class="n">max_y</span> <span class="o">=</span> <span class="n">s_maxs</span><span class="p">[</span><span class="n">exceeded_quantile</span><span class="p">]</span>

    <span class="n">idxs_to_remove</span> <span class="o">=</span> <span class="p">(</span><span class="n">cleaned_x</span> <span class="o">&gt;</span> <span class="n">min_x</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cleaned_y</span> <span class="o">&lt;</span> <span class="n">max_y</span><span class="p">)</span>

    <span class="n">cleaned_x</span> <span class="o">=</span> <span class="n">cleaned_x</span><span class="p">[</span><span class="o">~</span><span class="n">idxs_to_remove</span><span class="p">]</span>
    <span class="n">cleaned_y</span> <span class="o">=</span> <span class="n">cleaned_y</span><span class="p">[</span><span class="o">~</span><span class="n">idxs_to_remove</span><span class="p">]</span>
</code></pre></div>
<p><br></p>
<p>Visualising the results we can clearly see that the unwanted periods have been removed</p>
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cleaned_x</span><span class="p">,</span> <span class="n">cleaned_y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cleaned&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
    <span class="n">eda</span><span class="o">.</span><span class="n">hide_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wind Speed (m/s)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Output (MW)&#39;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../img/nbs/ug-03-power-curve_cell_29_output_0.png" /></p>
<p><br></p>
<p>We're now ready to make our power curve LOWESS estimate again</p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">time</span>

<span class="n">lowess_model</span> <span class="o">=</span> <span class="n">lowess</span><span class="o">.</span><span class="n">Lowess</span><span class="p">()</span>
<span class="n">lowess_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cleaned_x</span><span class="p">,</span> <span class="n">cleaned_y</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">num_fits</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lowess_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_pred</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pred</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Robust LOWESS&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cleaned_x</span><span class="p">,</span> <span class="n">cleaned_y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observations&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">eda</span><span class="o">.</span><span class="n">hide_spines</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wind Speed (m/s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Output (MW)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span>

<span class="n">lgnd</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
<span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="n">lgnd</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Wall time: 728 ms
</code></pre></div>
<p><img alt="png" src="../img/nbs/ug-03-power-curve_cell_31_output_1.png" /></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../ug-02-ligo/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                LIGO
              </div>
            </div>
          </a>
        
        
          <a href="../ug-04-electricity-prices/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Electricity Prices
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.08c56446.min.js"></script>
      <script src="../assets/javascripts/bundle.6ced434e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: ['header.autohide', 'navigation.tabs', 'navigation.instant', 'search.suggest'],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full,Safe&amp;delayStartupUntil=configured"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/config/TeX-AMS-MML_HTMLorMML-full.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/config/Safe.js?V=2.7.9"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/extensions/Safe.js?V=2.7.9"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/jax/output/HTML-CSS/fonts/STIX-Web/fontdata.js?V=2.7.9"></script>
      
    
  </body>
</html>